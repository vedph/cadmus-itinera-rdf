# Work Mappings

- [JSON mappings](work-mappings.json)

These mappings refer to work items. A work item is an item representing a literary work. The work's EID is provided in the item's `MetadataPart`.

## Item

As each work item has a metadata part, we map its `eid` metadatum as the work's ID. To make it a globally unique URI, the mapping builds it as follows:

1. prefix `itn:works/`
2. work item's GUID
3. `/` + work EID

where (2) grants its uniqueness, and (1+3) its friendliness.

Also, this node is the subject of a triple telling that the work is a CIDOC-CRM E90 symbolic object.

## Events

Events related to the work are listed in the work item's events part. The event type is provided by a thesaurus entry, and so are the relation types for that event with reference to directly related entities.

In general:

- each event corresponds to an entity node, whose URI is `itn:events/PART-GUID/EID`.
- each event has at least 3 triples where the event is the subject:
  - event is an E7 activity.
  - event P2 has type + the event's type as derived from the thesaurus entry. The entity for this entry has URI `itn:event-types/ID`.
  - event P16 used specific object + the work entity. This connects the event with its work.

Also, a number of children mappings are provided for each event mapping. The following mappings are always the same, and thus shared among all the event mappings:

- description for the event's optional description.
- note for the event's optional note.
- chronotopes for the event's optional date(s)/time(s).

Also, there is an additional child mapping for each type of relation in the list of the event's related entities. For instance, the _text sent_ event has these possible relations:

- sender
- recipient
- has participant

Each of these mappings outputs 1 node for the related entity, and at least 1 triple connecting the event with the related entity.

As a sample, this child mapping:

```json
{
  "name": "text sent event/related/has_participant",
  "source": "relatedEntities[?relation=='text:send:recipient']",
  "output": {
    "nodes": {
      "recipient": "{@id.target.gid}"
    },
    "triples": ["{?event} crm:P11_has_participant {?recipient}"]
  }
}
```

matches the relation type `text:send:recipient`, and outputs:

- a node for the recipient, whose URI is equal to the link's target GID.
- a triple telling that event P11 has participant recipient.

### Editorial Conventions

The entities involved in the events, and more generally in other parts, require a preliminary decision about editorial conventions. Most Cadmus models linking their data to entities outside the model itself do it via a link model which can be used both for external and internal links.

**External links** are just globally unique identifiers drawn from some LOD ontology (as URI, e.g. DBPedia) or any other external resources. For instance, <http://dbpedia.org/resource/Petrarch> could be the URI used for Petrarch.

**Internal links** are links cross referencing two entities found in the Cadmus database, via entity IDs (EIDs). An EID can be assigned to an item as a whole (via its `MetadataPart`, by a convention assuming that the metadatum named eid refers to the item including that part), or to any entity defined in a part's model. The provided UI (from bricks) allows user to lookup these EIDs by just typing any of their characters, and eventually filter them by item and part.

In both cases, the [link model](https://github.com/vedph/cadmus-bricks-shell/blob/master/projects/myrmidon/cadmus-refs-asserted-ids/README.md#asserted-composite-id) is the same, and includes a GID, i.e. a globally unique ID, plus some metadata. For external links, the GID is just the ID entered by users. For internal links, the GID usually is generated by a convention which ensures both a human-readable and globally unique ID, by merging a GUID (from a part or item) with the human-friendly EID. For instance, a GID like:

```txt
P3e04b8d1-7b55-4de7-b2b8-3097017c7c82/petrarch
```

can be dissected as:

- a `P` prefix telling us that the GUID belongs to a part (for an item we would have `I`).
- the part's (or item's) GUID.
- the EID (here `petrarch`) prefixed by `/`.

>The UI also allows users to customize the GID, if your Cadmus project is configured for this (via a thesaurus).


